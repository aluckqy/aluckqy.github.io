(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-index"],{1269:function(t,a,e){"use strict";(function(t,s){e("7a82"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var n={onShow:function(){try{this.userdata=uni.getStorageSync("userdata"),this.username=uni.getStorageSync("username"),this.password=uni.getStorageSync("password")}catch(a){t("log",a," at pages/index/index.vue:94")}},data:function(){return{username:"",password:"",userdata:{},modalName:null,modalTitle:"",modalMsg:"",switchA:!1,loadModal:!1}},methods:{showModal:function(t,a){this.modalName="Modal",this.modalTitle=t,this.modalMsg=a},hideModal:function(){this.modalName=null},SwitchA:function(t){this.switchA=t.detail.value},OutLogin:function(t){uni.clearStorageSync(),uni.reLaunch({url:"/pages/index/index"})},LoadModal:function(t){this.loadModal=t},SwitchState:function(a,e,n,i){var o=this;this.LoadModal(!0),s.callFunction({name:"databaseApi",data:{method:"putSwitch",database:"user-data-CN",parameter:{index:i[n],_id:e,state:a.detail.value}}}).then((function(a){t("log",a," at pages/index/index.vue:144"),o.loginuser()}))},loginadmin:function(){var a=this;this.username&&this.password?(this.LoadModal(!0),s.callFunction({name:"databaseApi",data:{method:"get",database:"admin-user",parameter:{username:this.username,password:this.password}}}).then((function(e){if(1==e.result.adminuser.affectedDocs){a.userdata=e.result.adminuser.data[0];try{uni.setStorageSync("userdata",e.result.adminuser.data[0]),uni.setStorageSync("form",e.result.form.data[0]),uni.setStorageSync("date",Math.floor(Date.now()/1e3)),uni.setStorageSync("username",a.username),uni.setStorageSync("password",a.password)}catch(s){t("log",s," at pages/index/index.vue:171")}}else a.showModal("登录失败","您的账号或密码有误！");a.LoadModal(!1)}))):this.showModal("登录失败","您的账号或密码不能为空！")},loginuser:function(){var a=this;this.username&&this.password?(this.LoadModal(!0),s.callFunction({name:"databaseApi",data:{method:"getuser",database:"user-data-CN",parameter:{username:this.username,password:this.password}}}).then((function(e){if(e.result.affectedDocs>0){for(var s=0,n=0;n<e.result.data.length;n++)e.result.data[n].users.length>0&&(s+=1);if(s>0){a.userdata=e.result.data;try{uni.setStorageSync("userdata",e.result.data),uni.setStorageSync("date",Math.floor(Date.now()/1e3)),uni.setStorageSync("username",a.username),uni.setStorageSync("password",a.password)}catch(i){t("log",i," at pages/index/index.vue:213")}}else a.showModal("登录失败","未查询到结果！")}else a.showModal("登录失败","您的账号或密码有误！");a.LoadModal(!1)}))):this.showModal("登录失败","您的账号或密码不能为空！")}}};a.default=n}).call(this,e("0de9")["log"],e("a9ff")["default"])},"33ab":function(t,a,e){"use strict";e.r(a);var s=e("8dac"),n=e("4d65");for(var i in n)["default"].indexOf(i)<0&&function(t){e.d(a,t,(function(){return n[t]}))}(i);var o=e("f0c5"),u=Object(o["a"])(n["default"],s["b"],s["c"],!1,null,"2a733722",null,!1,s["a"],void 0);a["default"]=u.exports},"4d65":function(t,a,e){"use strict";e.r(a);var s=e("1269"),n=e.n(s);for(var i in s)["default"].indexOf(i)<0&&function(t){e.d(a,t,(function(){return s[t]}))}(i);a["default"]=n.a},"8dac":function(t,a,e){"use strict";e.d(a,"b",(function(){return s})),e.d(a,"c",(function(){return n})),e.d(a,"a",(function(){}));var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-uni-view",[t.userdata.usertoken?e("basics"):t.userdata?e("v-uni-view",[e("cu-custom",{attrs:{bgColor:"bg-gradual-pink"}},[e("template",{attrs:{slot:"content"},slot:"content"},[t._v("修改")])],2),t._l(t.userdata,(function(a,s){return e("v-uni-view",{key:s},[a.users.length?e("v-uni-view",[e("v-uni-view",{staticClass:"cu-bar bg-white solid-bottom margin-top"},[e("v-uni-view",{staticClass:"action"},[e("v-uni-text",{staticClass:"cuIcon-title text-orange"}),t._v("<"+t._s(a.location)+"> "+t._s(a.group))],1)],1),t._l(a.users,(function(s,n){return e("v-uni-view",{key:n,staticClass:"cu-form-group"},[e("v-uni-view",{staticClass:"title"},[t._v("姓名："+t._s(s.name)+"   工号："+t._s(s.workid))]),e("v-uni-switch",{class:s.state?"checked":"",attrs:{checked:!!s.state},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),function(e){return t.SwitchState(e,a._id,n,a.userlistindex)}.apply(void 0,arguments)}}})],1)}))],2):t._e()],1)})),e("v-uni-view",{staticClass:"cu-bar btn-group margin-top"},[e("v-uni-button",{staticClass:"cu-btn bg-red shadow-blur round lg",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.OutLogin.apply(void 0,arguments)}}},[t._v("退出登录")])],1)],2):e("v-uni-form",[e("cu-custom",{attrs:{bgColor:"bg-gradual-pink"}},[e("template",{attrs:{slot:"content"},slot:"content"},[t._v("登录")])],2),e("v-uni-view",{staticClass:"solids-bottom padding-xs flex align-center margin-top"},[e("v-uni-view",{staticClass:"flex-sub text-center"},[e("v-uni-view",{staticClass:"text-xl padding"},[t.switchA?e("v-uni-text",{staticClass:"text-black text-bold"},[t._v("管理员登录入口")]):e("v-uni-text",{staticClass:"text-black text-bold"},[t._v("普通用户登录入口")])],1),t.switchA?e("v-uni-text",[t._v("仅供各班组管理员登录")]):e("v-uni-text",[t._v("账号为姓名，密码为工号")])],1)],1),e("v-uni-view",{staticClass:"cu-form-group margin-top"},[e("v-uni-view",{staticClass:"title"},[t._v("账号")]),e("v-uni-input",{attrs:{placeholder:"请输入账号",name:"input"},model:{value:t.username,callback:function(a){t.username=a},expression:"username"}})],1),e("v-uni-view",{staticClass:"cu-form-group"},[e("v-uni-view",{staticClass:"title"},[t._v("密码")]),e("v-uni-input",{attrs:{placeholder:"请输入密码",type:"password",name:"input"},model:{value:t.password,callback:function(a){t.password=a},expression:"password"}})],1),e("v-uni-view",{staticClass:"cu-form-group margin-top"},[e("v-uni-view",{staticClass:"title"},[t._v("管理员账号")]),e("v-uni-switch",{class:t.switchA?"checked":"",attrs:{checked:!!t.switchA},on:{change:function(a){arguments[0]=a=t.$handleEvent(a),t.SwitchA.apply(void 0,arguments)}}})],1),e("v-uni-view",{staticClass:"box margin-top"},[e("v-uni-view",{staticClass:"cu-bar btn-group"},[e("v-uni-button",{staticClass:"cu-btn bg-green shadow-blur round lg",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.switchA?t.loginadmin():t.loginuser()}}},[t._v("登录")])],1)],1)],1),e("v-uni-view",{staticClass:"cu-modal",class:"Modal"==t.modalName?"show":""},[e("v-uni-view",{staticClass:"cu-dialog"},[e("v-uni-view",{staticClass:"cu-bar bg-white justify-end"},[e("v-uni-view",{staticClass:"content"},[t._v(t._s(t.modalTitle))]),e("v-uni-view",{staticClass:"action",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.hideModal.apply(void 0,arguments)}}},[e("v-uni-text",{staticClass:"cuIcon-close text-red"})],1)],1),e("v-uni-view",{staticClass:"padding-xl"},[t._v(t._s(t.modalMsg))])],1)],1),t.loadModal?e("v-uni-view",{staticClass:"cu-load load-modal"},[e("v-uni-image",{attrs:{src:"https://mp-2349e2b3-2bda-47db-937e-a03686d78af1.cdn.bspapp.com/static/loading.png",mode:"aspectFit"}}),e("v-uni-view",{staticClass:"gray-text"},[t._v("加载中...")])],1):t._e()],1)},n=[]}}]);